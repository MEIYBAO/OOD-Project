{"version":3,"sources":["../src/index.js"],"names":["require","readdirSync","readFileSync","writeFileSync","lstatSync","exec","path","prettier","chalk","config","process","env","PWD","sgf","console","log","yellow","err","results","stagedFiles","filter","file","status","map","filename","Object","keys","formatFiles","key","Boolean","bold","write","extensions","options","checkExtension","filePath","encoding","formattedFile","format","flag","fileExtension","substr","lastIndexOf","extension","includes"],"mappings":";;AAEA;;eAEgEA,QAAQ,IAAR,C;IAAxDC,W,YAAAA,W;IAAaC,Y,YAAAA,Y;IAAcC,a,YAAAA,a;IAAeC,S,YAAAA,S;;gBACjCJ,QAAQ,eAAR,C;IAATK,I,aAAAA,I;;AACR,IAAMC,OAAON,QAAQ,MAAR,CAAb;AACA,IAAMO,WAAWP,QAAQ,UAAR,CAAjB;AACA,IAAMQ,QAAQR,QAAQ,OAAR,CAAd;AACA,IAAMS,SAAST,QAAWU,QAAQC,GAAR,CAAYC,GAAvB,kBAAf;AACA,IAAMC,MAAMb,QAAQ,kBAAR,CAAZ;;AAEAc,QAAQC,GAAR,CAAYP,MAAMQ,MAAN,CAAa,2BAAb,CAAZ;;AAEAH,IAAI,UAASI,GAAT,EAAcC,OAAd,EAAuB;AACvB,QAAID,GAAJ,EAAS,OAAOA,GAAP;;AAET,QAAME,cAAcD,QAAQE,MAAR,CAAe;AAAA,eAAQC,KAAKC,MAAL,KAAgB,SAAxB;AAAA,KAAf,EAAkDC,GAAlD,CAAsD;AAAA,eAAQF,KAAKG,QAAb;AAAA,KAAtD,CAApB;;AAEAC,WAAOC,IAAP,CAAYjB,MAAZ,EAAoBc,GAApB,CAAwB,eAAO;AAC3B,eAAOI,YAAYlB,OAAOmB,GAAP,CAAZ,EAAyBT,WAAzB,EACFC,MADE,CACKS,OADL,EAEFN,GAFE,CAEE,uBAAe;AAChBT,oBAAQC,GAAR,gBAAyBP,MAAMsB,IAAN,CAAWX,WAAX,CAAzB;AACA,mBAAOA,WAAP;AACH,SALE,EAMFI,GANE,CAME;AAAA,mBAAQlB,kBAAgBgB,IAAhB,CAAR;AAAA,SANF,CAAP;AAOH,KARD;AASH,CAdD;;AAgBA,IAAMM,cAAc,SAAdA,WAAc,OAAiCR,WAAjC,EAAiD;AAAA,QAA9CY,KAA8C,QAA9CA,KAA8C;AAAA,QAAvCC,UAAuC,QAAvCA,UAAuC;AAAA,QAA3BC,OAA2B,QAA3BA,OAA2B;;AACjE,WAAOd,YAAYI,GAAZ,CAAgB,oBAAY;AAC/B,YAAI,CAACW,eAAeC,QAAf,EAAyBH,UAAzB,CAAL,EAA2C;;AAE3C,YAAMX,OAAOnB,aAAaiC,QAAb,EAAuB,EAAEC,UAAU,OAAZ,EAAvB,CAAb;AACA,YAAMC,gBAAgB9B,SAAS+B,MAAT,CAAgBjB,IAAhB,EAAsBY,OAAtB,CAAtB;;AAEA9B,sBAAcgC,QAAd,EAAwBE,aAAxB,EAAuC,EAAED,UAAU,OAAZ,EAAqBG,MAAM,GAA3B,EAAvC;;AAEA,eAAOJ,QAAP;AACH,KATM,CAAP;AAUH,CAXD;;AAaA,IAAMD,iBAAiB,SAAjBA,cAAiB,CAACV,QAAD,EAAWQ,UAAX,EAA0B;AAC7C,WAAOA,WACFT,GADE,CACE,qBAAa;AACd,YAAMiB,gBAAgBhB,SAASiB,MAAT,CAAgBjB,SAASkB,WAAT,CAAqB,GAArB,CAAhB,CAAtB;;AAEA,eAAOF,iBAAiBG,SAAxB;AACH,KALE,EAMFC,QANE,CAMO,IANP,CAAP;AAOH,CARD","file":"index.js","sourcesContent":["\n\n\"use strict\";\n\nconst { readdirSync, readFileSync, writeFileSync, lstatSync } = require(\"fs\");\nconst { exec } = require(\"child_process\");\nconst path = require(\"path\");\nconst prettier = require(\"prettier\");\nconst chalk = require('chalk');\nconst config = require(`${process.env.PWD}/.prettierrc`);\nconst sgf = require(\"staged-git-files\");\n\nconsole.log(chalk.yellow(\"running precommit hook...\"));\n\nsgf(function(err, results) {\n    if (err) return err;\n\n    const stagedFiles = results.filter(file => file.status !== \"Deleted\").map(file => file.filename);\n\n    Object.keys(config).map(key => {\n        return formatFiles(config[key], stagedFiles)\n            .filter(Boolean)\n            .map(stagedFiles => {\n                console.log(`formatted ${chalk.bold(stagedFiles)}`);\n                return stagedFiles;\n            })\n            .map(file => exec(`git add ${file}`));\n    });\n});\n\nconst formatFiles = ({ write, extensions, options }, stagedFiles) => {\n    return stagedFiles.map(filePath => {\n        if (!checkExtension(filePath, extensions)) return;\n\n        const file = readFileSync(filePath, { encoding: \"utf-8\" });\n        const formattedFile = prettier.format(file, options);\n\n        writeFileSync(filePath, formattedFile, { encoding: \"utf-8\", flag: \"w\" });\n\n        return filePath;\n    });\n};\n\nconst checkExtension = (filename, extensions) => {\n    return extensions\n        .map(extension => {\n            const fileExtension = filename.substr(filename.lastIndexOf(\".\"));\n\n            return fileExtension == extension;\n        })\n        .includes(true);\n};\n"]}